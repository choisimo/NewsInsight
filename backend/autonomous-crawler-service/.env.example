# ===================================
# Autonomous Crawler Service Configuration
# ===================================
# Copy this file to .env and fill in the values
#
# NOTE: In production, configuration is loaded from Consul KV.
# These environment variables serve as fallback and for local development.
# Consul KV prefix: config/autonomous-crawler/

# -----------------------------------
# Consul Configuration
# -----------------------------------
CONSUL_ENABLED=true
CONSUL_HOST=localhost
CONSUL_PORT=8500
CONSUL_HTTP_TOKEN=
CONSUL_SERVICE_NAME=autonomous-crawler

# -----------------------------------
# Service Settings
# -----------------------------------
SERVICE_NAME=autonomous-crawler-service
LOG_LEVEL=INFO
LOG_FORMAT=json

# -----------------------------------
# Kafka Settings
# -----------------------------------
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_CONSUMER_GROUP_ID=autonomous-crawler-group
KAFKA_BROWSER_TASK_TOPIC=newsinsight.crawl.browser.tasks
KAFKA_CRAWL_RESULT_TOPIC=newsinsight.crawl.results
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=false
KAFKA_MAX_POLL_RECORDS=1

# -----------------------------------
# Browser Settings
# -----------------------------------
BROWSER_HEADLESS=true
BROWSER_MAX_CONCURRENT_SESSIONS=2
BROWSER_DEFAULT_TIMEOUT_SECONDS=300
BROWSER_MAX_TIMEOUT_SECONDS=600
BROWSER_SCREENSHOT_DIR=/tmp/crawler-screenshots
# Browser backend: 'playwright' (Chrome) or 'camoufox' (Firefox anti-detect)
BROWSER_BACKEND=playwright
# Set to true when running in Docker
BROWSER_IS_DOCKER_ENV=false

# -----------------------------------
# LLM Settings
# -----------------------------------
LLM_PROVIDER=openai
LLM_OPENAI_API_KEY=your-openai-api-key
LLM_OPENAI_MODEL=gpt-4o
LLM_ANTHROPIC_API_KEY=your-anthropic-api-key
LLM_ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
LLM_TEMPERATURE=0.0
LLM_MAX_TOKENS=4096

# -----------------------------------
# Search API Settings
# (API-based search to bypass CAPTCHA)
# -----------------------------------
# Brave Search API (https://brave.com/search/api/)
SEARCH_BRAVE_API_KEY=your-brave-api-key

# Tavily Search API (https://tavily.com/)
SEARCH_TAVILY_API_KEY=your-tavily-api-key

# Perplexity API (https://docs.perplexity.ai/)
SEARCH_PERPLEXITY_API_KEY=your-perplexity-api-key

# Search configuration
SEARCH_TIMEOUT=30.0
SEARCH_MAX_RESULTS_PER_PROVIDER=10
SEARCH_MAX_TOTAL_RESULTS=30
SEARCH_ENABLE_PARALLEL=true

# -----------------------------------
# Stealth/Anti-Detection Settings
# -----------------------------------
STEALTH_ENABLED=true
STEALTH_HIDE_WEBDRIVER=true
STEALTH_HIDE_AUTOMATION=true
STEALTH_MASK_WEBGL=true
STEALTH_RANDOM_USER_AGENT=false
# NopeCHA CAPTCHA solver extension (free, open-source)
STEALTH_USE_NOPECHA=true
STEALTH_NOPECHA_API_KEY=
# Advanced JavaScript patches for bot detection bypass
STEALTH_USE_ADVANCED_PATCHES=true
# Human-like behavior simulation
STEALTH_SIMULATE_HUMAN_BEHAVIOR=true

# -----------------------------------
# Camoufox Settings (Firefox anti-detect browser)
# Requires: pip install camoufox[geoip] && python -m camoufox fetch
# -----------------------------------
CAMOUFOX_ENABLED=true
CAMOUFOX_HUMANIZE=true
# Humanization level: 1=low, 2=medium, 3=high
CAMOUFOX_HUMANIZE_LEVEL=2
CAMOUFOX_GEOIP=true
CAMOUFOX_BLOCK_WEBRTC=true
CAMOUFOX_BLOCK_IMAGES=false
CAMOUFOX_LOCALE=ko-KR
CAMOUFOX_TIMEZONE=Asia/Seoul
# OS fingerprint: windows, macos, linux, random
CAMOUFOX_OS_TYPE=random

# -----------------------------------
# CAPTCHA Solving Settings
# (Uses open-source solvers only)
# -----------------------------------
CAPTCHA_ENABLED=true
CAPTCHA_PREFER_AUDIO=true
CAPTCHA_CLOUDFLARE_DELAY=10
CAPTCHA_MAX_ATTEMPTS=3

# -----------------------------------
# Metrics Settings
# -----------------------------------
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
